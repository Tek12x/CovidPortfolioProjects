/*
Cleaning Data in SQL Queries
Using BeeKeeper Studio
*/

SELECT *
FROM Nashville_Housing_Data


-- Populate Property Address data


Select DISTINCT PropertyAddress
FROM Nashville_Housing_Data

    
Select a.ParcelID, a.PropertyAddress, b.ParcelID, b.PropertyAddress, IFNULL(a.PropertyAddress,b.PropertyAddress)
From Nashville_Housing_Data a
INNER JOIN Nashville_Housing_Data b
	on a.ParcelID = b.ParcelID
	AND a.UniqueID <> b.UniqueID
Where a.PropertyAddress is null;

-- 35 Property Address were NULL after Query. Noticed that the ParcelID was linked to an address. Used it to fill in the NULL areas.


Select PropertyAddress
FROM Nashville_Housing_Data
WHERE Propertyaddress IS NULL;



Update Nashville_Housing_Data
SET PropertyAddress = IFNULL(a.PropertyAddress, b.PropertyAddress)
From Nashville_Housing_Data a
INNER JOIN Nashville_Housing_Data b
	ON a.ParcelID = b.ParcelID
	AND a.UniqueID <> b.UniqueID
Where a.PropertyAddress is null;

--Query was causing all PropertyAddress to have the same value inputed

UPDATE Nashville_Housing_Data
SET PropertyAddress = (
  SELECT IFNULL(a.PropertyAddress, b.PropertyAddress)
  FROM Nashville_Housing_Data a
  INNER JOIN Nashville_Housing_Data b
    ON a.ParcelID = b.ParcelID
    AND a.UniqueID <> b.UniqueID
  WHERE a.PropertyAddress IS NULL
)
WHERE PropertyAddress IS NULL;

--Try doing a subquery inside the SET and was able input address



